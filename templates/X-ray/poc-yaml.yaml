name: poc-yaml
set:
  randInt0: randomInt(1000, 9999)
  randStr1: randomLowercase(10)
  reverse: newReverse()
  reverseURL: reverse.url

transport: http
rules:
  r1:
    request:
      method: POST
      path: /path
      body: |
        data=aaa
      follow_redirects: false
      headers:
        Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
        Accept-Encoding: gzip, deflate
        Accept-Language: zh-CN,zh;q=0.9
        Cache-Control: no-cache
        Connection: close
        Pragma: no-cache
        Upgrade-Insecure-Requests: '1'
        User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36
          (KHTML, like Gecko) Chrome/123.0.0.0 Safari/537.36
      expression: |
        response.status == 200 && response.body.bcontains(b"example") 

      output:
        search: |
          r'(?P<info>\|.*\|)'.bsubmatch(response.raw)
        info: search["info"]
  r2:
    request:
      method: POST
      path: /path
      body: |
        data=aaa
      follow_redirects: false
      headers:
        Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
        Accept-Encoding: gzip, deflate
        Accept-Language: zh-CN,zh;q=0.9
        Cache-Control: no-cache
        Connection: close
        Pragma: no-cache
        Upgrade-Insecure-Requests: '1'
        User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36
          (KHTML, like Gecko) Chrome/123.0.0.0 Safari/537.36
      expression: |
        response.status == 200 && response.body.bcontains(b"example") 

      output:
        search: |
            r'(?P<info>\|.*\|)'.bsubmatch(response.raw)
        info: search["info"]

expression: r1() && r2()

detail:
  author: DawnT0wn